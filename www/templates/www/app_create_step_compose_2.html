{% extends 'www/raster.html' %}
{% load i18n %}
{% load staticfiles %}
{% block extracss %}
{{ block.super }}
<link rel="stylesheet" href='{% static "www/css/base.css" %}' />
<link rel="stylesheet" href='{% static "www/css/newapp.css" %}' />
<link rel="stylesheet" href='{% static "www/css/newappstep.css" %}' />
{% endblock %}
{% block extrajs %}
<script src='{% static "www/js/compose-step.js" %}'></script>
{% endblock %}

{% block main-content%}

<section class="wrapper site-min-height">
    <section class="main-box">
        <input type="hidden" id="currentTeantName" name="currentTeantName" value="{{tenantName}}" />
        <input type="hidden" id="service_code_from" name="service_code_from" value="{{cur_type}}">
        <input type="hidden" id="service_code_clone_url" name="service_code_clone_url" value="">
        <input type="hidden" id="service_code_version" name="service_code_version" value="">
        <input type="hidden" id="service_code_id" name="service_code_id" value="">
        <input type="hidden" id="group_id" name="group_id" value="{{group_id}}">
        <input type="hidden" id="compose_file_id" name="group_id" value="{{compose_file_id}}">
            <!--单价信息-->
        <input type="hidden" id="pre_paid_memory_price" name="pre_paid_memory_price" value="{{pre_paid_memory_price}}">
        <input type="hidden" id="post_paid_memory_price" name="post_paid_memory_price" value="{{post_paid_memory_price}}">
        <input type="hidden" id="pre_paid_disk_price" name="pre_paid_disk_price" value="{{pre_paid_disk_price}}">
        <input type="hidden" id="post_paid_disk_price" name="post_paid_disk_price" value="{{post_paid_disk_price}}">
        <input type="hidden" id="post_paid_net_price" name="post_paid_net_price" value="{{post_paid_net_price}}">
        <!--是否为付费用户-->
        <input type="hidden" id="is_tenant_free" name="is_tenant_free" value="{{is_tenant_free}}">
        <input type="hidden" id="image_url" value="{{image_url}}">
        <input type="hidden" id="tenantNameValue" value="{{tenantName}}">
        <input type="hidden" id="parse_error" value="{{parse_error}}">
        <input type="hidden" id="compose_relations" value="{{compose_relations}}">
        <h3 class="main-tit">创建一组应用</h3>
        <div class="app-step clearfix three">
            <p class="sed"><span>1</span><cite>提交compose文件</cite></p>
            <p class="sed"><span>2</span><cite>创建应用</cite></p>
            <p><span>3</span><cite>应用设置</cite></p>
        </div>
        <!-- main start -->
        <form id="myFormTwo">
            <input type="hidden" id="compose_relations" value="{{compose_relations}}">
            <!-- tab tit -->
            <div class="tablink">
                <a href="javascript:;" class="sed">总览</a>
                {% for service in service_list %}
                <a href="javascript:;" >{{service.name}}</a>
                {% endfor %}
            </div>
            <!-- tab tit -->
            <!-- 切换 start -->
            <!-- 总览  -->
            <section id="overview" class="fn-app-box" style="display: block;">
                <div class="view-svg" id="view-svg">
                    
                </div>
            </section>
            {% for service in service_list %}
            <input type="hidden" name="depends_on" value="{{service.depends_on}}">
            <input type="hidden" name="image" value="{{service.image}}">
            <section id="{{service.service_id}}" service_cname="{{service.name}}" service_image="{{service.image}}" class="fn-app-box fn-circle"  style="none: block;" >
                <!-- 基本信息  start-->
                <div class="infor-fm-box">
                    <h4 class="step-tit">基本信息</h4>
                    <div class="fm-input-text clearfix">
                        <label for="{{service.service_id}}_create_app_name">应用名</label><input type="text" id="{{service.service_id}}_create_app_name" name="create_app_name" value="{{service.name}}" placeholder="给应用取个名字，支持中英文。" disabled="true"  />
                    </div>
                    <p class="fm-tips">请输入应用名！</p>
                    <!--
                    <div class="fm-select clearfix">
                        <label>选择分组</label>
                        <select id="{{service.service_id}}_group-name" name="select_group_id">
                            <option value="-1">不分组</option>
                            {% for group in groupList %}
                            <option value="{{group.ID}}" >{{group.group_name}}</option>
                            {% endfor %}
                            <option value="-2">新建组</option>
                        </select>
                    </div>
                    -->
                </div>
                <!-- 基本信息  end-->
                <!-- 配套信息 start -->
                <div class="infor-fm-box">
                    <h4 class="step-tit">内存选项</h4>
                    <!-- 01 -->
                    <div class="fm-input-range clearfix fn-memory-node">
                        <label>单节点内存</label>
                        {% if is_tenant_free %}
                        <p class="range-box nouser fn-tips" data-tips="新用户单应用内存最大1G，全部应用总内存最大1G。付费用户无限制。">
                            <span class="renge-bg"></span>
                            <span class="range-choose"><cite id="{{service.service_id}}_OneMemoryWid"></cite></span>
                            <input type="range" min="128" max="1024"  step="128" id="{{service.service_id}}_OneMemory" value="128"／>
                        </p>
                        <!-- user -->
                        {% else %}
                        <!-- no user -->
                        <p class="range-box fn-tips" data-tips="单应用内存最大8G，总内存无限。如需使用更多，请联系客服申请。>
                            <span class="renge-bg"></span>
                            <span class="range-choose"><cite id="{{service.service_id}}_OneMemoryWid"></cite></span>
                            <input type="range" min="128" max="8192"  step="128" id="{{service.service_id}}_OneMemory" value="128"／>
                        </p>
                        <!-- no user -->
                        {% endif %}
                        <span><cite id="{{service.service_id}}_OneMemoryText">128M</cite></span>
                    </div>
                    <div class="fm-input-range clearfix fn-memory-node">
                        <label>节点数</label>
                        {% if is_tenant_free %}
                        <p class="range-box nouser02 fn-tips" data-tips="新用户单应用只能创建1个节点，付费用户可创建100个节点。">
                            <span class="renge-bg"></span>
                            <span class="range-choose"><cite id="{{service.service_id}}_NodeWid"></cite></span>
                            <input type="range" min="1" max="1"  step="1" id="{{service.service_id}}_NodeNum" value="1"／>
                        </p>
                        <!-- user -->
                        {% else %}
                        <!-- no user -->
                        <p class="range-box fn-tips" data-tips="单应用最多可创建100个节点。如需创建更多，请联系客服申请。">
                            <span class="renge-bg"></span>
                            <span class="range-choose"><cite id="{{service.service_id}}_NodeWid"></cite></span>
                            <input type="range" min="1" max="100"  step="1" id="{{service.service_id}}_NodeNum" value="1"／>
                        </p>
                        <!-- no user -->
                        {% endif %}
                        <span><cite id="{{service.service_id}}_NodeText">1</cite>个</span>
                    </div>
                    <div class="fm-input-radio clearfix">
                        <label>内存使用方式</label>
                        <input type="radio" name="{{service.service_id}}Memory" value="{{service.service_id}}Before" id="{{service.service_id}}_MoneyBefore" checked="true" />
                        <label class="radio-bg" for="{{service.service_id}}_MoneyBefore"></label>
                        <label for="{{service.service_id}}_MoneyBefore" class="radio-text fn-tips" data-tips="包月购买内存，整体费用相对便宜，支持随时扩容，在包月时长用完后会自动转为按小时扣费。">包月包年（5折）</label>
                        <input type="radio" name="{{service.service_id}}Memory" value="{{service.service_id}}After" id="{{service.service_id}}_MoneyAfter" />
                        <label class="radio-bg"  for="{{service.service_id}}_MoneyAfter"></label>
                        <label for="{{service.service_id}}_MoneyAfter" class="radio-text fn-tips" data-tips="内存按小时扣费，支持随时扩容和缩容。">按小时扣费（<cite class="aft-memory"></cite>元/GB/小时）</label>
                    </div>
                </div>
                <div class="infor-fm-box">
                    <h4 class="step-tit">磁盘选项</h4>
                    <!-- 02 -->
                    <div class="fm-choose-box clearfix">
                        <label>磁盘存储</label>
                        <div class="btn-cho-box clearfix">
                            <p class="clearfix"><input type="checkbox" id="{{service.service_id}}_fbscc" checked="true"  disabled="true" /><label class="cho-bg" for="{{service.service_id}}_fbscc"></label><label for="{{service.service_id}}_fbscc" class="cho-text fn-tips" data-tips="默认免费支持，暂不可取消。">分布式存储</label></p>
                            <p class="clearfix"><input type="checkbox" id="{{service.service_id}}_ssd" checked="true"  disabled="true" /><label class="cho-bg" for="{{service.service_id}}_ssd"></label><label for="{{service.service_id}}_ssd" class="cho-text fn-tips" data-tips="默认免费支持，暂不可取消。">SSD</label></p>
                        </div>
                    </div>
                    <div class="fm-input-radio clearfix">
                        <label>磁盘使用方式</label>
                        <input type="radio" name="{{service.service_id}}Disk" value="{{service.service_id}}DiskAfter" id="{{service.service_id}}_DiskAfter" checked="true"/>
                        <label class="radio-bg"  for="{{service.service_id}}_DiskAfter"></label>
                        <label for="{{service.service_id}}_DiskAfter" class="radio-text fn-tips" data-tips="免费额度可覆盖绝大部分应用，超出部分按实际使用量付费。">300MB以内免费（超出部分<cite class="aft-disk"></cite>元/GB/小时）</label>
                        <input type="radio" name="{{service.service_id}}Disk" value="{{service.service_id}}DiskBefore" id="{{service.service_id}}_DiskBefore"  />
                        <label class="radio-bg" for="{{service.service_id}}_DiskBefore"></label>
                        <label for="{{service.service_id}}_DiskBefore" class="radio-text fn-tips" data-tips="提前采购存储，支持随时扩容，超出额度部分按小时扣费。包月时长用完自动转为按小时扣费。">打包购买</label>
                    </div>
                    <div class="fm-input-range clearfix" id="{{service.service_id}}_disk_box" style="display: none;">
                        <label>购买额度</label>
                        {% if is_tenant_free %}
                        <p class="range-box nouser02 fn-tips" data-tips="新用户单应用可购买容量最大1G，付费用户最大1000G。">
                            <span class="renge-bg"></span>
                            <span class="range-choose"><cite id="{{service.service_id}}_DiskWid"></cite></span>
                            <input type="range" min="1" max="1"  step="1" id="{{service.service_id}}_Disk" value="1"／>
                        </p>
                        <!-- user -->
                        {% else %}
                        <!-- no user -->
                        <p class="range-box fn-tips" data-tips="单应用最多可购买1000G。如需使用更多，请联系客服申请。">
                            <span class="renge-bg"></span>
                            <span class="range-choose"><cite id="{{service.service_id}}_DiskWid"></cite></span>
                            <input type="range" min="1" max="1000"  step="1" id="{{service.service_id}}_Disk" value="1"／>
                        </p>
                        <!-- no user -->
                        {% endif %}
                        <span><cite id="{{service.service_id}}_DiskText">1</cite>G</span>
                    </div>
                </div>
                <div class="infor-fm-box">
                    <h4 class="step-tit">网络选项</h4>
                    <!-- 03 -->
                    <div class="fm-input-radio clearfix">
                        <label>网络流量</label>
                        <input type="radio" name="{{service.service_id}}flow" value="{{service.service_id}}flow" id="{{service.service_id}}_flow" checked="true" disabled="true" />
                        <label class="radio-bg" for="{{service.service_id}}_flow"></label>
                        <label class="radio-text fn-tips" for="{{service.service_id}}_flow" data-tips="应用只有开放对外访问才会计算流量，目前仅支持按使用每小时扣费，请保持账户有一定余额。">按小时扣费（<cite class="aft-net"></cite>元/GB）</label>
                    </div>
                </div>
                <div class="infor-fm-box">
                    <h4 class="step-tit">其他选项</h4>
                    <!-- 04 -->
                    <div class="fm-choose-box clearfix">
                        <label>计算资源</label>
                        <div class="btn-cho-box clearfix">
                            <p class="clearfix"><input type="checkbox" id="{{service.service_id}}_dlzy" checked="true" /><label class="cho-bg" for="{{service.service_id}}_dlzy"></label><label for="{{service.service_id}}_dlzy" class="cho-text fn-tips" data-tips="默认支持，现阶段免费使用。">独立资源</label></p>
                            <p class="clearfix"><input type="checkbox" id="{{service.service_id}}_fzjh" checked="true" /><label class="cho-bg" for="{{service.service_id}}_fzjh"></label><label for="{{service.service_id}}_fzjh" class="cho-text fn-tips" data-tips="默认支持，现阶段免费使用。">负载均衡</label></p>
                            <p class="clearfix"><input type="checkbox" id="{{service.service_id}}_txss" checked="true" /><label class="cho-bg" for="{{service.service_id}}_txss"></label><label for="{{service.service_id}}_txss" class="cho-text fn-tips" data-tips="默认支持，现阶段免费使用。">弹性伸缩</label></p>
                            <p class="clearfix"><input type="checkbox" id="{{service.service_id}}_sfkz" checked="true" /><label class="cho-bg" for="{{service.service_id}}_sfkz"></label><label for="{{service.service_id}}_sfkz" class="cho-text fn-tips" data-tips="默认支持，现阶段免费使用。">三份快照</label></p>
                        </div>
                    </div>
                    <div class="fm-choose-box clearfix">
                        <label>部署回滚</label>
                        <div class="btn-cho-box clearfix">
                            <p class="clearfix"><input type="checkbox" id="{{service.service_id}}_yjbs" checked="true" /><label class="cho-bg" for="{{service.service_id}}_yjbs"></label><label for="{{service.service_id}}_yjbs" class="cho-text fn-tips" data-tips="默认支持，现阶段免费使用。">一键部署</label></p>
                            <p class="clearfix"><input type="checkbox" id="{{service.service_id}}_yjhg" checked="true" /><label class="cho-bg" for="{{service.service_id}}_yjhg"></label><label for="{{service.service_id}}_yjhg" class="cho-text fn-tips" data-tips="默认支持，现阶段免费使用。">一键回滚</label></p>
                            <p  class="clearfix"><input type="checkbox" id="{{service.service_id}}_gdsj" checked="true" /><label class="cho-bg" for="{{service.service_id}}_gdsj"></label><label for="{{service.service_id}}_gdsj" class="cho-text fn-tips" data-tips="默认支持，现阶段免费使用。">滚动升级</label></p>
                        </div>
                    </div>
                    <div class="fm-choose-box clearfix">
                        <label>日志监控</label>
                        <div class="btn-cho-box clearfix">
                            <p class="clearfix"><input type="checkbox" id="{{service.service_id}}_xnfxgj" checked="true" /><label class="cho-bg" for="{{service.service_id}}_xnfxgj"></label><label for="{{service.service_id}}_xnfxgj" class="cho-text fn-tips" data-tips="默认支持，现阶段免费使用。">性能分析</label></p>
                            <p class="clearfix"><input type="checkbox" id="{{service.service_id}}_ywjkgj" checked="true" /><label class="cho-bg" for="{{service.service_id}}_ywjkgj"></label><label for="{{service.service_id}}_ywjkgj" class="cho-text fn-tips" data-tips="默认支持，现阶段免费使用。">业务监控</label></p>
                            <p class="clearfix"><input type="checkbox" id="{{service.service_id}}_fbsrz" checked="true" /><label class="cho-bg" for="{{service.service_id}}_fbsrz"></label><label for="{{service.service_id}}_fbsrz" class="cho-text fn-tips" data-tips="默认支持，现阶段免费使用。">分布式日志</label></p>
                        </div>
                    </div>
                </div>
                <!-- 配套信息 end -->
                <!-- 费用估算 start -->
                <div id="{{service.service_id}}_baoyuegoumai" class="infor-fm-box">
                    <h4 class="step-tit">包月购买</h4>
                    <div class="fm-input-range clearfix">
                        <label>包月时长</label>
                        <ul class="range-box clearfix buy_month">
                            <li class="active" data-time="1">1<span>个月</span></li>
                            <li data-time="2">2<span>个月</span></li>
                            <li data-time="3">3<span>个月</span></li>
                            <li data-time="4">4<span>个月</span></li>
                            <li data-time="5">5<span>个月</span></li>
                            <li data-time="6">6<span>个月</span></li>
                            <li data-time="7">7<span>个月</span></li>
                            <li data-time="8">8<span>个月</span></li>
                            <li data-time="9">9<span>个月</span></li>
                            <li class="fn-tips" data-tips="购买一年8.5折优惠" data-time="12">1年</li>
                            <li class="fn-tips" data-tips="购买两年7.5折优惠" data-time="24">2年</li>
                        </ul>
                        <!--<span><cite id="TimeLongText">1</cite>个月</span>   -->
                    </div>
                    <div class="fm-money clearfix">
                        <label>包月费用折后总计</label>
                        <span class="fn-tips"  data-tips="该包月费用在应用正常运行后才会提请您支付。本费用不包括其他按小时扣费的项目，请保持账户有一定余额。"><cite id="{{service.service_id}}_need-money"></cite>元</span>
                        <i>原价：</i><del class="before_money"></del><i>元</i>
                    </div>
                </div>
                <!-- 费用估算 end -->   
            </section>
            {% endfor %}
            <!--  error  -->
            {% if parse_error %}
            <section>
                <h4> 解析出错</h4>
                <h5>{{parse_error_info}}</h5>
            </section>
            {% endif %}
            <!-- 切换 end -->
            <!-- 提交 start -->
            <div class="build-app-btn fn-tips" style="margin-top: 30px;" data-tips="当前应用成功创建后，{% if is_tenant_free %}7天{% else %}1小时{% endif %}内可免费调试，开始计费后请保持账户有一定余额。">
                <button class="btn  btn-success" id="compose2">免费创建</button>
            </div>
            <!-- 提交 end -->
        </form>
        <!-- main end -->
    </section>
</section>
{% endblock %}
