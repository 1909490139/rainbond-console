{% extends 'www/raster.html' %}
{% load i18n %}
{% load crispy_forms_tags %}
{% load goodrain_extras %}

{% load staticfiles %}
{% block extracss %}
{{ block.super }}
<link rel="stylesheet" href='{% static "www/css/base.css" %}' />
<link rel="stylesheet" href='{% static "www/css/newapp.css" %}' />
<link rel="stylesheet" href='{% static "www/css/newappstep.css" %}' />
{% endblock %}

{% block main-content%}

<section class="wrapper site-min-height">
    <input type="hidden" value={{group_id}}>
    <section class="main-box">
        <h3 class="main-tit">创建组应用</h3>
        <div class="app-step clearfix three">
            <p class="sed"><span>1</span><cite>组信息</cite></p>
            <p class="sed"><span>2</span><cite>创建应用</cite></p>
            <p class="sed"><span>3</span><cite>应用设置</cite></p>
        </div>
        <div class="tablink">
            {% for service in service_list %}
            <a href="javascript:;">{{service_cname_map|mkey:serivce.service_key}}</a>
            {% endfor %}
        </div>
        {% for service in service_list %}
        <section class="app-box fn-app-box" data-key="{{service.service_key}}" data-version="{{service.version}}" data-id="{{service.ID}}">
            <h4 class="column-tit">端口管理</h4>
            <table class="tab-box">
                <thead>
                <tr>
                    <th>端口</th>
                    <th>协议</th>
                    <th>对内服务</th>
                    <th>对外服务</th>
                </tr>
                </thead>
                <tbody class="port">
                {% with service_port_list=app_port_map|mkey:service.service_key %}
                {% for service_port in service_port_list %}
                <tr>
                    <td>{{service_port.port_alias}}{{service_port.container_port}}</td>
                    <td>{{service_port.protocol}}</td>
                    <td>
                        <div class="checkbox">
                            <input type="checkbox" name="" value="" id="{{service_port.container_port}}inner" checked="true" disabled="disabled"/>
                            <label class="check-bg" for="{{service_port.container_port}}inner"></label>
                        </div>
                    </td>
                    <td>
                        <div class="checkbox">
                            <input class="checkDetail" type="checkbox" name="" value="" id="{{service_port.container_port}}outer" disabled="disabled"/>
                            <label class="check-bg" for="{{service_port.container_port}}outer"></label>
                        </div>
                    </td>
                </tr>
                {% endfor %}
                {% endwith %}
                </tbody>
            </table>
            <div class="serviceBlock">
                <h4 class="column-tit">服务依赖</h4>
                <table class="tab-box">
                    <thead>
                    <tr>
                        <th>应用名称</th>
                        <th>应用类型</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% with dep_service_list=app_relation_map|mkey:service.service_key %}
                    {% for dep_service in dep_service_list %}
                    <tr>
                        <td>{{dep_service.dep_app_alias}}</td>
                        <td>{{dep_service.dep_app_version}}</td>
                    </tr>
                    {% endfor %}
                    {% endwith %}
                    </tbody>
                </table>
            </div>
        </section>
        {% endfor %}
        <p class="text-center">
            <button class="greenbtn" style="cursor: pointer;">下一步</button>
        </p>
    </section>
</section>
{% endblock %}
{% block extrajs %}
<script src='{% static "www/js/groupinstall/group-step-three.js" %}'></script>
{% endblock %}