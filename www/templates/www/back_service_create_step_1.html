{% extends 'www/raster.html' %} 

{% load i18n %} 

{% load goodrain_extras %}

{% block main-content%}

<section class="wrapper site-min-height">
	<!-- page start-->
	<section class="panel">
		<div class="panel-body">
			<div class=" form">
				<form class="cmxform form-horizontal tasi-form" id="commentForm"
					method="post" action="" novalidate="novalidate">
					<input type="hidden" id="tenantName" name="tenantName" value="{{tenantName}}" />
					<input type="hidden" id="service_key" name="service_key" value="{{service_key}}" />
					<input type="hidden" id="app_version" name="app_version" value="{{app_version}}" />

					<div class="form-group">
						<div class="col-lg-12 ">
							<div
								class="col-lg-offset-3 col-lg-6 alert text-center alert-default fade in">
								<h2>{{service.service_name}}服务创建</h2>
							</div>
						</div>
					</div>
					<div class="form-group ">
						<label for="create_app_name"
							class="control-label col-lg-2 app_name">名称</label>
						<div class="col-lg-8">
							<input class="form-control valid" id="create_service_name"
								name="create_service_name" minlength="2" type="text" required=""
								placeholder="给服务起个名字">
							<div id="create_service_notice" class="alert alert-danger"
								role="alert"
								style="padding: 8px 12px; margin: 5px 0 0 0; display: none;">英文小写字母开始结束, 允许包含数字, 中划线 -</div>
						</div>
					</div>
					<div class="form-group ">
						<label for="create_app_name"
							class="control-label col-lg-2 app_name">内存大小</label>
						<div class="col-lg-8">
							<select class="form-control" style="width: 150px" id="service_memory" name="service_memory">
    							{% for cuMemory in memoryList %} 
                                  {% with curMemory=cuMemory|strToInt %}
                                  {% if curMemory == service.min_memory %}
                                  <option value="{{cuMemory}}"  selected="selected">{{memorydict|mkey:cuMemory}}</option>
                                  {% else %}
                                  <option value="{{cuMemory}}">{{memorydict|mkey:cuMemory}}</option>
                                  {% endif %}
                                  {% endwith %}
                                {% endfor %}
							</select>
						</div>
					</div>					
					{% if dependecy_services %}
						{% for key, deployed_services in dependecy_services.items %}
						<div class="form-group">
						  	<label class="col-sm-2 control-label col-lg-2" for="inputSuccess">依赖{{dependecy_info|mkey:key}}-{{dependecy_version|mkey:key}}服务</label>
						  	<div class="col-lg-10">
						  		<select class="form-control col-lg-2" style="width: 150px" name="dependency_service">
						  		    <option value=""></option>
						  			<option value="__new__:{{key}}:{{dependecy_version|mkey:key}}" selected="selected">新建</option>
						  			{% if deployed_services %}
						  			{% for d_service in deployed_services %}
						  			<option value="{{d_service.service_alias}}:{{key}}:{{d_service.version}}">{{d_service.service_alias}}</option>
						  			{% endfor %}
						  			{% endif %}
						  		</select>
						  	</div>
						</div>
						{% endfor %}
												
						<!--div class="form-group ">
							<div id="create_dependency_service_notice" class="alert alert-danger"
									role="alert"
									style="padding: 8px 12px; margin: 5px 0 0 0; display: none;">当前服务依赖的服务不能为空</div>
						</div-->
					{% endif %}
					<div class="col-lg-offset-3 col-lg-6 ">
						<button type="button" id="back_service_step1"
							class="btn btn-lg btn-success btn-block">下一步</button>
					</div>
				</form>
			</div>
		</div>
	</section>
	<!-- page end-->
</section>
<script type="text/javascript">
	$(document).ready(function () {
		//取消回车事件
		$("#create_service_name").keydown(function(e){
			var curKey = e.which;
			if(curKey == 13){
				return false;
			}
		});
	});
</script>
{% endblock %}
