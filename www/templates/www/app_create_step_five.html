{% extends 'www/raster.html' %}
{% load i18n %}
{% load staticfiles %}
{% block extracss %}
{{ block.super }}
<link rel="stylesheet" href='{% static "www/css/base.css" %}' />
<link rel="stylesheet" href='{% static "www/css/newapp.css" %}' />
<link rel="stylesheet" href='{% static "www/css/newappstep.css" %}' />
{% endblock %}
{% block extrajs %}
<script src='{% static "www/js/newcompose.js" %}'></script>
{% endblock %}

{% block main-content%}

<section class="wrapper site-min-height">
    <input type="hidden" id="image_url" value="{{image_url}}">
    <input type="hidden" id="tenantNameValue" value="{{tenantName}}">
    <input type="hidden" id="compose_file_id" value="{{compose_file_id}}">
    <input type="hidden" id="parse_error" value="{{parse_error}}">
    <input type="hidden" id="compose_relations" value="{{compose_relations}}">
    <section class="main-box">
        <div class="app-step clearfix two">
            <p><span>1</span><cite>设置镜像来源</cite></p>
            <p class="sed"><span>2</span><cite>设置应用参数</cite></p>
        </div>
        <!-- start -->
        <div class="tablink">
            <a href="javascript:;" class="sed">总览</a>
            {% for service in service_list %}
            <a href="javascript:;" >{{service.name}}</a>
            {% endfor %}
        </div>
        <!-- 总览 start -->
        <section id="overview" class="fn-app-box" style="display: block;">
            <!--<p style=" text-align: center; padding: 10px 20px;"><label>应用组名:</label><input type="text" value="" id="com-name" placeholder="{{compose_group_name}}"/></p>-->
            <div class="view-svg" id="view-svg">
                
            </div>
        </section>
        <!-- 总览 end -->
        <!-- 01-->
        {% for service in service_list %}
        <input type="hidden" name="depends_on" value="{{service.depends_on}}">
        <input type="hidden" name="image" value="{{service.image}}">
        <section id="{{service.service_id}}" service_cname="{{service.name}}" service_image="{{service.image}}" class="app-box fn-app-box"  style="none: block;" >
            <!-- 应用端口 start -->
            <section class="box-single">
                <h3>应用端口</h3>
                <!--<table class="table table-striped table-advance table-hover new-port">-->
                    <!--<thead>-->
                        <!--<tr>-->
                            <!--<th>名称</th>-->
                            <!--<th>容器端口</th>-->
                            <!--<th>协议类型</th>-->
                            <!--<th>默认开启对内服务</th>-->
                            <!--<th>默认开启外部访问</th>-->
                            <!--<th>操作</th>-->
                        <!--</tr>-->
                    <!--</thead>-->
                    <!--<tbody>-->
                    <!--{% for outer_port in service.ports %}-->
                        <!--<tr>-->
                            <!--<td><span>{{service.name|upper}}</span></td>-->
                            <!--<td><span>{{outer_port}}</span></td>-->
                            <!--<td><span>{% if service.name in linked_service %}stream{% else %}http{% endif %}</span></td>-->
                            <!--<td><input class="fn-input-inner" name="inner" type="checkbox" {% if service.name in linked_service %} checked="checked" {% endif %} disabled="true"></td>-->
                            <!--<td><input class="fn-input-outer" name="outer" type="checkbox"  disabled="true"></td>-->
                            <!--<td><a href="javascript:;" class="fn-revise">修改</a> &nbsp;&nbsp;<a href="javascript:;" class="fn-delete">删除</a></td>-->
                        <!--</tr>-->
                    <!--{% endfor %}-->
                    <!--{% for inner_port in service.expose %}-->
                        <!--<tr>-->
                            <!--<td><span>S{{inner_port}}</span></td>-->
                            <!--<td><span>{{inner_port}}</span></td>-->
                            <!--<td><span>http</span></td>-->
                            <!--<td><input class="fn-input-inner" name="inner" type="checkbox"  disabled="true"></td>-->
                            <!--<td><input class="fn-input-outer" name="outer" type="checkbox"  disabled="true"></td>-->
                            <!--<td><a href="javascript:;" class="fn-revise">修改</a><a href="javascript:;" class="fn-delete">删除</a></td>-->
                        <!--</tr>-->
                    <!--{% endfor %}-->
                    <!--</tbody>-->
                <!--</table>-->
                <!--<div class="new-box" >-->
                    <!--<div class="addport-box">-->
                        <!--<p class="add-port"><label>容器端口:</label><input type="text" placeholder="端口只能是数字"/></p>-->
                        <!--<p class="add-agreement">-->
                            <!--<label>协议类型:</label>-->
                            <!--<select>-->
                                <!--<option value="http">http</option>-->
                                <!--<option value="stream">stream</option>-->
                            <!--</select>-->
                        <!--</p>-->
                        <!--<p class="add-inner"><label>对内服务:</label><input type="checkbox" /></p>-->
                        <!--<p class="add-outer"><label>外部访问:</label><input type="checkbox" /></p>-->
                    <!--</div>-->
                    <!--<p>-->
                        <!--<a href="javascript:;" class="fn-newapp btn btn-success">新增</a>-->
                        <!--<a href="javascript:;" class="fn-newapp-sure btn btn-success">确认新增</a>-->
                        <!--<a href="javascript:;" class="fn-newapp-cancel btn btn-danger">取消新增</a>-->
                    <!--</p>-->
                <!--</div>-->

                <table class="tab-box">
                    <thead>
                    <tr>
                        <th>端口</th>
                        <th>对外服务</th>
                        <th>外部访问</th>
                        <th colspan="2">访问方式</th>
                    </tr>
                    </thead>
                    <tbody class="port">
                    <!--{% for port in service_ports %}-->
                    <tr data-port="5000port">
                        <td>
                            <a href="javascript:void(0);" class="portNum edit-port fn-tips" data-tips="源码中无 Dockerfile 文件时，默认开启服务端口为5000，请勿随意更改。如果当前应用为多端口应用，请根据您编码中定义的端口自行添加。">5000</a>
                        </td>
                        <td>
                            <div class="checkbox fn-tips" data-tips="打开对外服务，其他应用即可访问当前应用。">
                                <input class="checkDetail" type="checkbox" name="" value="" id="5000inner"/>
                                <label class="check-bg" for="5000inner"></label>
                            </div>
                        </td>
                        <td>
                            <div class="checkbox fn-tips" data-tips="打开外部访问，用户即可通过互联网访问当前应用。">
                                <input class="checkDetail" type="checkbox" name="" value="" id="5000outer"/>
                                <label class="check-bg" for="5000outer"></label>
                            </div>
                        </td>
                        <td>
                            <select data-port-http="5000Http" class="fn-tips" data-tips="如果允许用户通过互联网采用HTTP协议访问当前应用，请选择HTTP。">
                                <option>HTTP</option>
                                <option>非HTTP</option>
                            </select>
                        </td>
                        <td>
                            <img class="rubbish" src="{% static "www/images/rubbish.png" %}"/>
                        </td>
                    </tr>
                    <!--{% endfor %}-->
                    </tbody>
                    <tfoot>
                    <tr class="addPort">
                        <td>
                            <input type="number" class="add_port fn-tips" data-tips="为了保证安全，服务端口支持范围为 1025~65535，如您的编码中提供对外服务端口不在此范围内，请修改编码。">
                            <p class="checkTip">请输入正确的端口号</p>
                        </td>
                        <td>
                            <div class="checkbox fn-tips" data-tips="打开对外服务，其他应用即可访问当前应用。">
                                <input type="checkbox" name="" value="" id="addInner{{service.service_id}}" />
                                <label class="check-bg" for="addInner{{service.service_id}}"></label>
                            </div>
                        </td>
                        <td>
                            <div class="checkbox fn-tips" data-tips="打开外部访问，用户即可通过互联网访问当前应用。">
                                <input type="checkbox" name="" value="" id="addOuter{{service.service_id}}" />
                                <label class="check-bg" for="addOuter{{service.service_id}}"></label>
                            </div>
                        </td>
                        <td>
                            <select class="add_http fn-tips" data-tips="如果允许用户通过互联网采用HTTP协议访问当前应用，请选择HTTP。">
                                <option>HTTP</option>
                                <option>非HTTP</option>
                            </select>
                        </td>
                        <td class="operation">
                            <span class="add lit-btn-green"><i class="fa fa-check"></i></span>
                            <span class="noAdd lit-btn-red"><i class="fa fa-times"></i></span>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="5">
                            <span class="openAdd">新增容器端口</span>
                        </td>
                    </tr>
                    </tfoot>
                </table>


            </section>
            <!-- 应用端口 end -->
            <!-- 环境变量 start -->
            <section class="box-single">
                <h3>环境变量</h3>
                <table class="table table-striped table-advance table-hover new-environment">
                    <thead>
                        <tr>
                            <th>名称</th>
                            <th>变量名</th>
                            <th>值</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for k,v in service.environment.items %}
                    <tr>
                        <td><span>{{k}}</span></td>
                        <td><span>{{k}}</span></td>
                        <td><span>{{v}}</span></td>
                        <td><a href="javascript:;" class="fn-env-revise">修改</a> &nbsp;&nbsp;<a href="javascript:;" class="fn-env-delete">删除</a></td>
                    </tr>
                    {% endfor %}
                    </tbody>
                </table>
                <div class="new-box">
                    <div class="environment-box">
                        <p class="environment-name"><label>名称:</label><input type="text" placeholder="中文名称"/></p>
                        <p class="environment-english"><label>变量名:</label><input type="text" placeholder="英文名称"/></p>
                        <p class="environment-value"><label>值:</label><input type="text" placeholder="请输入值"/></p>
                    </div>
                    <p>
                        <a href="javascript:;" class="fn-environment btn btn-success">新增</a>
                        <a href="javascript:;" class="fn-environment-sure btn btn-success">确认新增</a>
                        <a href="javascript:;" class="fn-environment-cancel btn btn-danger">取消新增</a>
                    </p>
                </div>
            </section>
            <!-- 环境变量 end -->
            <!-- 持久化目录 start-->
            <section class="box-single">
                <h3>持久化目录</h3>
                <table class="table table-striped table-advance table-hover new-directory">
                    <thead>
                    <tr>
                        <th>目录</th>
                        <th>操作</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for volume in service.volumes %}
                    <tr>
                        <td><span> {{volume}} </span> </td>
                        <td><a href="javascript:;" class="fn-dir-revise">修改</a> &nbsp;&nbsp;<a href="javascript:;" class="fn-dir-delete">删除</a></td>
                    </tr>
                    {% endfor %}
                    </tbody>
                </table>
                <div class="new-box">
                    <div class="directory-box">
                        <p class="directory-name"><label>目录:</label><input type="text" placeholder="请输入目录"/></p>
                    </div>
                    <p>
                        <a href="javascript:;" class="fn-directory btn btn-success">新增</a>
                        <a href="javascript:;" class="fn-directory-sure btn btn-success">确认新增</a>
                        <a href="javascript:;" class="fn-directory-cancel btn btn-danger">取消新增</a>
                    </p>
                </div>
            </section>
            <!-- 持久化目录 end-->
            <!-- 资源要求 start -->
            <section class="box-single">
                <h3>资源要求</h3>
                <select class="resources">
                    <option value="128">128M</option>
                    <option value="256">256M</option>
                    <option value="512">512M</option>
                    <option value="1024">1G</option>
                    <option value="2048">2G</option>
                    <option value="3072">3G</option>
                    <option value="4096">4G</option>
                    <option value="5120">5G</option>
                </select>
            </section>
            <!-- 资源要求 end -->
            <!-- 启动命令 start -->
            <section class="box-single">
                <h3>启动命令</h3>
                <textarea rows="4" class="order" >{% if service.command %}{{service.command}}{% endif %}</textarea>
            </section>
            <!-- 启动命令 end -->
            <!--依赖服务 start -->
            {% if service.depends_on|length > 0 or service.links|length > 0 %}
            <section  class="box-single">
                <h3>依赖服务</h3>
                <div id="depends_service">
                    {% for dep in service.depends_on %}
                        <span>{{dep}}</span>
                    {% endfor %}
                    {% for link in service.links %}
                    <span>{{link}}</span>
                    {% endfor %}
                </div>
            </section>
            {% endif %}
            <!--依赖服务 end-->

        </section>
        {% endfor %}
        <!-- 01-->
        <!-- 02-->
        {% if parse_error %}
            <section>
                <h4> 解析出错</h4>
                <h5>{{parse_error_info}}</h5>
            </section>
        {% endif %}

        <!-- 02-->
        <!-- 03-->

        <!-- 03-->
        <!-- 提交 start -->
        <div class="build-app-btn">
            <a href="javascript:;" class="btn btn-info" id="pre_page">上一页</a>
            {% if not parse_error %}
            <a href="javascript:;" class="btn  btn-success" id="build-app">建立一组应用</a>
            {% endif %}
        </div>
        <!-- 提交 end -->
        <!-- end -->
    </section>
</section>
{% endblock %}
